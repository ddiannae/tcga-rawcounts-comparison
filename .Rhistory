merged.annot["13253",]
merged.annot["6879",]
merged.annot["6879", "EnsemblId"] <- "ENSG00000188092"
merged.annot["6879", "Symbol.y"] <- "GPR89B"
merged.annot["6879",]
merged.annot["8772",]
merged.annot["8772", "EnsemblId"] <- "ENSG00000187272"
merged.annot["8772", "Symbol.y"] <- "KRTAP9-8"
merged.annot["8772",]
merged.annot["18208",]
merged.annot["18208",]
merged.annot["18208", "EnsemblId"] <- "ENSG00000182986"
merged.annot["18208", "Symbol.y"] <- "ZNF320"
merged.annot["18208",]
merged.annot["16591",]
merged.annot["16591", "EnsemblId"] <- "ENSG00000158427"
merged.annot["16591", "Symbol.y"] <- "TMSB15B"
merged.annot["16591",]
merged.annot["11643",]
merged.annot["11643", "EnsemblId"] <- "ENSG00000238269"
merged.annot["11643", "Symbol.y"] <- "PAGE2B"
merged.annot["15942",]
merged.annot["15942",]
merged.annot["15942", "EnsemblId"] <- "ENSG00000278299"
merged.annot["15942", "Symbol.y"] <- "TBC1D3C"
merged.annot["15942",]
merged.annot["4078",]
merged.annot["4078", "EnsemblId"] <- "ENSG00000268940"
merged.annot["4078", "Symbol.y"] <- "CT45A1"
merged.annot["4078",]
merged.annot["7026",]
merged.annot["7026", "EnsemblId"] <- "ENSG00000183474"
merged.annot["7026", "Symbol.y"] <- "GTF2H2C"
merged.annot["7026",]
merged.annot["4448",]
merged.annot["4448",]
merged.annot["4448", "EnsemblId"] <- "ENSG00000099974"
merged.annot["4448", "Symbol.y"] <- "DDTL"
merged.annot["4448",]
length(merged.annot$EnsemblId)
lengths(merged.annot$EnsemblId)
lengths(merged.annot[, "EnsemblId"])
?apply
apply(merged.annot$EnsemblId, 1, nchar )
apply(merged.annot$EnsemblId, 2, nchar )
apply(merged.annot$EnsemblId,nchar )
lapply(merged.annot$EnsemblId, nchar )
nchar(merged.annot["4448", "EnsemblId"])
?nchar
class(merged.annot$EnsemblId)
nchar(as.character(merged.annot["4448", "EnsemblId"]))
lapply(as.character(merged.annot$EnsemblId), nchar)
?all
all(lapply(as.character(merged.annot$EnsemblId), nchar) == 15)
### Duplicates Ensambl Take 3
dup.ensembl.ids <- which(duplicated(merged.annot$EnsemblId))
dup.ensembl <-unique(merged.annot[dup.ensembl.ids, "EnsemblId"])
dup.ensembl.rows <- merged.annot[which(merged.annot$EnsemblId %in% dup.ensembl), ]
dim(dup.ensembl.rows)
###[1] 64  9
length(unique(dup.ensembl.rows$EntrezId))
##[1] 35 :(
dup.ensembl.rows$EntrezId <- as.numeric(dup.ensembl.rows$EntrezId)
dup.ensembl.rows <- dup.ensembl.rows[order(dup.ensembl.rows$EntrezId), ]
dim(dup.ensembl.rows)
##[1] 35 :(
dup.ensembl.in.dup.entrez <- dup.entrez.rows[which(duplicated(dup.entrez.rows$EnsemblId)), c("EntrezId", "EnsemblId")]
dup.ensembl.in.dup.entrez <- merged.annot[merged.annot$EntrezId %in% dup.ensembl.in.dup.entrez$EntrezId
| merged.annot$EnsemblId %in% dup.ensembl.in.dup.entrez$EnsemblId , ]
dup.ensembl.in.dup.entrez <- dup.ensembl.in.dup.entrez[order(dup.ensembl.in.dup.entrez$EnsemblId, dup.ensembl.in.dup.entrez$EntrezId), ]
dup.ensembl.in.dup.entrez
merged.annot[duplicated(merged.annot[,c("EntrezId", "EnsemblId")]), ]
### Duplicates Ensambl Take 3
merged.annot[duplicated(merged.annot[,c("EntrezId", "EnsemblId")]), ]
duplicated.entrez.ensembl <- duplicated(merged.annot[,c("EntrezId", "EnsemblId")])
duplicated.entrez.ensembl.rows <- merged.annot[merged.annot$EntrezId %in% duplicated.entrez.ensembl$EntrezId |
merged.annot$EnsemblId %in% duplicated.entrez.ensembl$EntrezId, ]
duplicated.entrez.ensembl
duplicated.entrez.ensembl <- merged.annot[duplicated(merged.annot[,c("EntrezId", "EnsemblId"), ,c("EntrezId", "EnsemblId")])
duplicated.entrez.ensembl <- merged.annot[duplicated(merged.annot[,c("EntrezId", "EnsemblId")]), c("EntrezId", "EnsemblId")]
duplicated.entrez.ensembl <- merged.annot[duplicated(merged.annot[,c("EntrezId", "EnsemblId")]), c("EntrezId", "EnsemblId")]
duplicated.entrez.ensembl
duplicated.entrez.ensembl.rows <- merged.annot[merged.annot$EntrezId %in% duplicated.entrez.ensembl$EntrezId |
merged.annot$EnsemblId %in% duplicated.entrez.ensembl$EntrezId, ]
duplicated.entrez.ensembl.rows
merged.annot[merged.annot$EnsemblId == "ENSG00000160014", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000160014" & merged.annot$EntrezId == "808", ]
merged.annot["2652",] = merged.annot["2653",]
merged.annot["2652",]
merged.annot[merged.annot$EnsemblId == "ENSG00000160014", ]
merged.annot[merged.annot$EntrezId == "808", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000196735" & merged.annot$EntrezId == "3117", ]
merged.annot["7374",] = merged.annot["7373",]
merged.annot["7374",]
merged.annot[merged.annot$EnsemblId == "ENSG00000196735", ]
merged.annot[merged.annot$EntrezId == "3117", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000231887" & merged.annot$EntrezId == "5554", ]
merged.annot["12754",]
merged.annot[merged.annot$EnsemblId == "ENSG00000231887"]
merged.annot[merged.annot$EnsemblId == "ENSG00000231887", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000231887" & merged.annot$EntrezId == "5554", ]
merged.annot["12754",] = merged.annot["12755", ]
merged.annot["12755"]
merged.annot["12755", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000231887", ]
merged.annot[merged.annot$EntrezId == "5554", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000177954" & merged.annot$EntrezId == "6232", ]
merged.annot["13942",] = merged.annot["13941",]
merged.annot[merged.annot$EnsemblId == "ENSG00000177954", ]
merged.annot[merged.annot$EntrezId == "6232", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000172062" & merged.annot$EntrezId == "6606", ]
merged.annot["15115",] = merged.annot["15114",]
merged.annot[merged.annot$EnsemblId == "ENSG00000172062", ]
merged.annot[merged.annot$EntrezId == "6606", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000244682" & merged.annot$EntrezId == "9103", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000244682", ]
merged.annot[merged.annot$EntrezId == "9103", ]
merged.annot["5920", "Start"] = 161581339
merged.annot["5920", "End"] = 	161605662
merged.annot["5920", "GC"] = 44.62
merged.annot["5920", "Type"] = "polymorphic_pseudogene"
merged.annot["5920", "EnsemblId"] <- "ENSG00000244682"
merged.annot["5920", "Symbol.y"] <- "FCGR2C"
merged.annot[merged.annot$EnsemblId == "ENSG00000244682", ]
merged.annot[merged.annot$EntrezId == "9103", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060" & merged.annot$EntrezId == "16795", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060" & merged.annot$EntrezId == "10597", ]
merged.annot["16795",] = merged.annot["16796",]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060", ]
merged.annot[merged.annot$EntrezId == "10597", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060" & merged.annot$EntrezId == "10597", ]
merged.annot["16795",] = merged.annot["16796",]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060", ]
merged.annot[merged.annot$EntrezId == "10597", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000169618" & merged.annot$EntrezId == "10887", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000169618", ]
merged.annot[merged.annot$EntrezId == "10887", ]
merged.annot["12825",]
merged.annot["12825", "EnsemblId"] <- "ENSG00000169618"
merged.annot["12825", "Symbol.y"] <- "PROKR1"
merged.annot["12825", "Start"] <- 68643589
merged.annot["12825", "End"] <- 	68658247
merged.annot["12825", "GC"] <- 46.47
merged.annot[merged.annot$EnsemblId == "ENSG00000169618", ]
merged.annot[merged.annot$EntrezId == "10887", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000144134" & merged.annot$EntrezId == "11159", ]
merged.annot["13253",] = merged.annot["13254",]
merged.annot[merged.annot$EnsemblId == "ENSG00000169618", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000144134" & merged.annot$EntrezId == "11159", ]
merged.annot["13253",] = merged.annot["13254",]
merged.annot[merged.annot$EnsemblId == "ENSG00000144134", ]
merged.annot[merged.annot$EntrezId == "11159", ]
merged.annot[merged.annot$EntrezId == "51463", ]
merged.annot["6879",] = merged.annot["6880",]
merged.annot[merged.annot$EnsemblId == "ENSG00000188092", ]
merged.annot[merged.annot$EntrezId == "51463", ]
merged.annot[merged.annot$EntrezId == "83901", ]
merged.annot[merged.annot$EntrezId == "83901", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000187272", ]
merged.annot["8772",] = merged.annot["8771",]
merged.annot[merged.annot$EntrezId == "83901", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000187272", ]
merged.annot[merged.annot$EntrezId == "162967", ]
merged.annot["18208",] <- merged.annot["18207",]
merged.annot[merged.annot$EnsemblId == "ENSG00000182986", ]
merged.annot[merged.annot$EntrezId == "83901", ]
merged.annot[merged.annot$EntrezId == "162967", ]
merged.annot[merged.annot$EntrezId == "286527", ]
merged.annot[merged.annot$EntrezId == "286527", ]
merged.annot["16591",] <- merged.annot["16592",]
merged.annot["16593",] <- merged.annot["16592",]
merged.annot[merged.annot$EntrezId == "286527", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000158427", ]
merged.annot[merged.annot$EntrezId == "389860", ]
merged.annot["11643",] <- merged.annot["11644",]
merged.annot[merged.annot$EntrezId == "389860", ]
merged.annot["11643",] <- merged.annot["11644",]
merged.annot[merged.annot$EnsemblId == "ENSG00000238269", ]
merged.annot[merged.annot$EntrezId == "389860", ]
merged.annot[merged.annot$EntrezId == "414060", ]
merged.annot[merged.annot$EntrezId == "414060", ]
merged.annot["15942",] <- merged.annot["15943",]
merged.annot[merged.annot$EnsemblId == "ENSG00000278299", ]
merged.annot[merged.annot$EntrezId == "414060", ]
merged.annot[merged.annot$EntrezId == "541466", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000268940", ]
merged.annot["4078",] <- merged.annot["4077",]
merged.annot[merged.annot$EnsemblId == "ENSG00000268940", ]
merged.annot[merged.annot$EntrezId == "541466", ]
merged.annot[merged.annot$EntrezId == "728340", ]
merged.annot["7026",] <- merged.annot["7025",]
merged.annot[merged.annot$EntrezId == "728340", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000183474", ]
merged.annot[merged.annot$EntrezId == "100037417", ]
merged.annot[merged.annot$EntrezId == "100037417", ]
merged.annot["4448",] <- merged.annot["4449",]
merged.annot[merged.annot$EnsemblId == "ENSG00000099974", ]
merged.annot[merged.annot$EntrezId == "100037417", ]
setwd("~/Workspace/raw-counts-comparison")
load(file="healthyRawLegacy.RData")
annot <- read.delim(file="Biomart_EnsemblG92_GRCh38_p12_NCBI.txt", sep="\t")
names(annot) <- c("EnsemblId", "Chr", "Start", "End", "GC", "Type", "Symbol", "EntrezId")
dim(annot)
## [1] 64927     8
levels(annot$Chr)
annot<-annot[annot$Chr%in%c(as.character(1:22), "X", "Y"),]
annot$Chr<-droplevels(annot$Chr)
table(annot$Chr)
dim(annot)
### Genes with no Symbol
annot.nosymbol <- annot[annot$Symbol=="", ]
annot.nosymbol
dim(annot.nosymbol)
##[1] 20925     8
annot.entrezna <- annot[is.na(annot$EntrezId),]
annot.entrezna
dim(annot.entrezna)
###### Healthy Data Frame
normal.df <- data.frame(normal$Counts)
head(normal.df)
dim(normal.df)
## [1] 20532   101
rownames(normal.df) <- as.numeric(normal$Annot[,2])
head(normal.df)
##[1] 20532     2
head(normal$Annot[,2])
dim(normal.df)
all.entrez <- unique(annot$EntrezId)
length(all.entrez)
## Should remove entrez ids that are not in all.entrez
out.entrez.ids <- which(!(rownames(normal.df) %in% all.entrez))
normal.df <- normal.df[-out.entrez.ids, ]
dim(normal.df)
#[1] 18578   101
normal$Annot <- normal$Annot[-out.entrez.ids,]
dim(normal$Annot)
################ Merge and remove duplicates
annot.normal <- data.frame(normal$Annot, stringsAsFactors = FALSE)
##Add Biomart data
merged.annot<-merge(x=annot.normal, y=annot, by="EntrezId", all=F, sort=FALSE)
dim(merged.annot)
#[1] 18639     9
merged.annot[duplicated(merged.annot[,c("EntrezId", "EnsemblId")]), ]
duplicated.entrez.ensembl <- merged.annot[duplicated(merged.annot[,c("EntrezId", "EnsemblId")]), c("EntrezId", "EnsemblId")]
duplicated.entrez.ensembl.rows <- merged.annot[merged.annot$EntrezId %in% duplicated.entrez.ensembl$EntrezId |
merged.annot$EnsemblId %in% duplicated.entrez.ensembl$EntrezId, ]
duplicated.entrez.ensembl.rows
ids.to.remove = c("2977", "2978", "2980")
merged.annot[ids.to.remove, ]
merged.annot <- merged.annot[!(rownames(merged.annot) %in% ids.to.remove), ]
dim(merged.annot)
##### Duplicates. EnsemblId
dup.ensembl.ids <- which(duplicated(merged.annot$EnsemblId))
dup.ensembl <-unique(merged.annot[dup.ensembl.ids, "EnsemblId"])
dup.ensembl.rows <- merged.annot[which(merged.annot$EnsemblId %in% dup.ensembl), ]
dim(dup.ensembl.rows)
###[1] 75  9
## We need to remove the duplicated EnsemblIds. Lets keep them but only one Entrez counts should count
## probaby take max
length(unique(dup.ensembl.rows$EntrezId))
## [1] 70
dup.entrez.in.dup.ensembl <- dup.ensembl.rows[which(duplicated(dup.ensembl.rows$EntrezId)), c("EntrezId", "EnsemblId")]
dup.entrez.in.dup.ensembl <- merged.annot[merged.annot$EntrezId %in% dup.entrez.in.dup.ensembl$EntrezId
| merged.annot$EnsemblId %in% dup.entrez.in.dup.ensembl$EnsemblId , ]
dup.entrez.in.dup.ensembl <- dup.entrez.in.dup.ensembl[order(dup.entrez.in.dup.ensembl$EnsemblId, dup.entrez.in.dup.ensembl$EntrezId), ]
dup.entrez.in.dup.ensembl
### Duplicates. Entrez.Ids
dup.entrez.ids <-which(duplicated(merged.annot$EntrezId))
dup.entrez <- unique(merged.annot[dup.entrez.ids, "EntrezId"])
dup.entrez.rows <- merged.annot[which(merged.annot$EntrezId %in% dup.entrez), ]
dim(dup.entrez.rows)
###[1] 117   9
length(unique(dup.ensembl.rows$EnsemblId))
## [1] 35
dup.ensembl.in.dup.entrez <- dup.entrez.rows[which(duplicated(dup.entrez.rows$EnsemblId)), c("EntrezId", "EnsemblId")]
dup.ensembl.in.dup.entrez <- merged.annot[merged.annot$EntrezId %in% dup.ensembl.in.dup.entrez$EntrezId
| merged.annot$EnsemblId %in% dup.ensembl.in.dup.entrez$EnsemblId , ]
dup.ensembl.in.dup.entrez <- dup.ensembl.in.dup.entrez[order(dup.ensembl.in.dup.entrez$EnsemblId, dup.ensembl.in.dup.entrez$EntrezId), ]
identical(dup.ensembl.in.dup.entrez, dup.entrez.in.dup.ensembl)
######################################
## dup.esenbl.in.dup.entrez has 150472 - ENSG00000215126 extra.
## check one by one
dup.ensembl.in.dup.entrez
merged.annot[merged.annot$EnsemblId == "ENSG00000196873", ]
merged.annot["2784", ] <- merged.annot["2785", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000196873", ]
merged.annot[merged.annot$EntrezId == "445571", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000215126", ]
merged.annot["2788", ] <- merged.annot["2787", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000215126", ]
merged.annot[merged.annot$EntrezId == "644019", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000183629", ]
merged.annot["6722", ] z- merged.annot["6721", ]
merged.annot[merged.annot$EntrezId == "283768", ]
merged.annot["6722", ] <- merged.annot["6721", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000183629", ]
merged.annot[merged.annot$EntrezId == "283768", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000205076", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000205076", ]
merged.annot["8946", ] <- merged.annot["8947", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000205076", ]
merged.annot[merged.annot$EntrezId == "3963", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000205076", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000153684", ]
merged.annot["6719", ] <- merged.annot["6720", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000153684", ]
merged.annot["6719", ] <- merged.annot["6720", ]
merged.annot[merged.annot$EntrezId == "100132565", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000153684", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000178934", ]
merged.annot[merged.annot$EntrezId == "653499", ]
merged.annot[merged.annot$EntrezId == merged.annot["8945", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == merged.annot["6719", "EntrezId"], ]
merged.annot[merged.annot$EntrezId == merged.annot["6719", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000196873", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000196873", ]
merged.annot[merged.annot$EntrezId == "445571", merged.annot["2784", "EntrezId"]]
merged.annot[merged.annot$EntrezId == merged.annot["2784", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000215126", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000215126", ]
merged.annot[merged.annot$EntrezId == merged.annot["2788", "EntrezId"] , ]
merged.annot[merged.annot$EnsemblId == "ENSG00000183629", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000183629", ]
merged.annot[merged.annot$EntrezId == merged.annot["6722", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000153684", ]
merged.annot[merged.annot$EntrezId == merged.annot["6719", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000178934", ]
merged.annot["8945", ] <- merged.annot["8944", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000178934", ]
merged.annot[merged.annot$EntrezId == merged.annot["8945", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000136682", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000136682", ]
merged.annot["2783", ] <- merged.annot["2782", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000136682", ]
merged.annot[merged.annot$EntrezId == merged.annot["2783", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000196873", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000215126", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000183629", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000205076", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000153684", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000153684", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000178934", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000178934", ]
merged.annot[merged.annot$EntrezId == merged.annot["8945", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000136682", ]
merged.annot["2783", ] <- merged.annot["2782", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000136682", ]
### We can remove Entrezid - Ensemblid duplicates
merged.annot[duplicated(merged.annot), ]
merged.annot <- merged.annot[!duplicated(merged.annot), ]
dim(merged.annot)
##### Duplicates. EnsemblId - Take2
dup.ensembl.ids <- which(duplicated(merged.annot$EnsemblId))
dup.ensembl <-unique(merged.annot[dup.ensembl.ids, "EnsemblId"])
dup.ensembl.rows <- merged.annot[which(merged.annot$EnsemblId %in% dup.ensembl), ]
dim(dup.ensembl.rows)
###[1] 62  9
length(unique(dup.ensembl.rows$EntrezId))
##[1] 62 YEI!!!
dup.ensembl.rows$EntrezId <- as.numeric(dup.ensembl.rows$EntrezId)
dup.ensembl.rows <- dup.ensembl.rows[order(dup.ensembl.rows$EntrezId), ]
dim(dup.ensembl.rows)
## [1] 62  9
dup.ensembl.rows
write.table(dup.ensembl.rows, file = "dup_ensembl_rows.tsv", quote=F, sep="\t")
### Check one by one
### Remove the ones with no EnsemblId
ids.to.remove = c("6338", "6341", "6340", "6073", "6337", "6339", "6343")
merged.annot[ids.to.remove, ]
merged.annot <- merged.annot[!(rownames(merged.annot) %in% ids.to.remove), ]
dim(merged.annot)
merged.annot[merged.annot$EnsemblId == "ENSG00000160014" & merged.annot$EntrezId == "808", ]
merged.annot["2652",] = merged.annot["2653",]
merged.annot["2652",]
merged.annot[merged.annot$EnsemblId == "ENSG00000160014", ]
merged.annot[merged.annot$EntrezId == merged.annot["2652", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000196735" & merged.annot$EntrezId == "3117", ]
merged.annot["7374",] = merged.annot["7373",]
merged.annot["7374",]
merged.annot[merged.annot$EnsemblId == "ENSG00000196735", ]
merged.annot[merged.annot$EntrezId == merged.annot["7374", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000231887" & merged.annot$EntrezId == "5554", ]
merged.annot["12754",] = merged.annot["12755", ]
merged.annot["12755", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000231887", ]
merged.annot[merged.annot$EntrezId == merged.annot["12755", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000177954" & merged.annot$EntrezId == "6232", ]
merged.annot["13942",] = merged.annot["13941",]
merged.annot[merged.annot$EntrezId == merged.annot["13941", "EntrezId"] ]
merged.annot[merged.annot$EntrezId == merged.annot["13941", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000172062" & merged.annot$EntrezId == "6606", ]
merged.annot["15115",] = merged.annot["15114",]
merged.annot[merged.annot$EnsemblId == "ENSG00000172062", ]
merged.annot[merged.annot$EntrezId == merged.annot["15115", "EntrezId"] , ]
merged.annot[merged.annot$EnsemblId == "ENSG00000244682" & merged.annot$EntrezId == "9103", ]
merged.annot["5920", "Start"] <- 161581339
merged.annot["5920", "End"] <- 	161605662
merged.annot["5920", "GC"] <- 44.62
merged.annot["5920", "Type"] <- "polymorphic_pseudogene"
merged.annot["5920", "EnsemblId"] <- "ENSG00000244682"
merged.annot["5920", "Symbol.y"] <- "FCGR2C"
merged.annot[merged.annot$EnsemblId == "ENSG00000244682", ]
merged.annot[merged.annot$EntrezId == "9103", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060" & merged.annot$EntrezId == "10597", ]
merged.annot["16795",] = merged.annot["16796",]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060", ]
merged.annot[merged.annot$EntrezId == merged.annot["16795", "EntrezId"] , ]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060" & merged.annot$EntrezId == "10597", ]
merged.annot["16795",] = merged.annot["16796",]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000256060", ]
merged.annot[merged.annot$EntrezId == merged.annot["16795", "EntrezId"] , ]
merged.annot[merged.annot$EnsemblId == "ENSG00000169618" & merged.annot$EntrezId == "10887", ]
merged.annot["12825",]
merged.annot["12825", "EnsemblId"] <- "ENSG00000169618"
merged.annot["12825", "Symbol.y"] <- "PROKR1"
merged.annot["12825", "Start"] <- 68643589
merged.annot["12825", "End"] <- 	68658247
merged.annot["12825", "GC"] <- 46.47
merged.annot[merged.annot$EnsemblId == "ENSG00000169618", ]
merged.annot[merged.annot$EntrezId == "10887", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000144134" & merged.annot$EntrezId == "11159", ]
merged.annot["13253",] = merged.annot["13254",]
merged.annot[merged.annot$EnsemblId == "ENSG00000144134", ]
merged.annot[merged.annot$EntrezId == merged.annot["13253", "EntrezId"], ]
merged.annot[merged.annot$EntrezId == "51463", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000188092" & merged.annot$EntrezId == "51463", ]
merged.annot["6879",] <- merged.annot["6880",]
merged.annot[merged.annot$EnsemblId == "ENSG00000188092", ]
merged.annot[merged.annot$EntrezId == merged.annot["6879", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000187272" & merged.annot$EntrezId == "83901", ]
merged.annot["8772",] = merged.annot["8771",]
merged.annot[merged.annot$EntrezId == "83901", ]
merged.annot[merged.annot$EnsemblId == merged.annot["8772", "EntrezId"] , ]
merged.annot["8772",] = merged.annot["8771",]
merged.annot[merged.annot$EntrezId == merged.annot["8772", "EntrezId"] , ]
merged.annot[merged.annot$EnsemblId == , ]
merged.annot[merged.annot$EnsemblId == "ENSG00000182986" & merged.annot$EntrezId == "162967", ]
merged.annot["18208",] <- merged.annot["18207",]
merged.annot[merged.annot$EntrezId == merged.annot["18208", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000187272" & merged.annot$EntrezId == "286527", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000158427" & merged.annot$EntrezId == "286527", ]
merged.annot["16591",] <- merged.annot["16592",]
merged.annot[merged.annot$EntrezId == merged.annot["16591", "EntrezId"], ]
merged.annot["16593",] <- merged.annot["16592",]
merged.annot[merged.annot$EnsemblId == "ENSG00000158427", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000238269" & merged.annot$EntrezId == "389860", ]
merged.annot["11643",] <- merged.annot["11644",]
merged.annot[merged.annot$EnsemblId == "ENSG00000238269", ]
merged.annot[merged.annot$EntrezId == merged.annot["11643", "EntrezId"] , ]
merged.annot[merged.annot$EnsemblId == "ENSG00000187272" & merged.annot$EntrezId == "414060", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000278299" & merged.annot$EntrezId == "414060", ]
merged.annot["15942",] <- merged.annot["15943",]
merged.annot[merged.annot$EnsemblId == "ENSG00000278299", ]
merged.annot[merged.annot$EntrezId == merged.annot["15942", "EntrezId"] , ]
merged.annot[merged.annot$EnsemblId == "ENSG00000268940" & merged.annot$EntrezId == "541466", ]
merged.annot["4078",] <- merged.annot["4077",]
merged.annot[merged.annot$EntrezId == merged.annot["4078", "EntrezId"], ]
merged.annot[merged.annot$EnsemblId == "ENSG00000183474" & merged.annot$EntrezId == "728340", ]
merged.annot["7026",] <- merged.annot["7025",]
merged.annot[merged.annot$EntrezId == "728340", ]
merged.annot[merged.annot$EntrezId == merged.annot["7026", "EntrezId"] , ]
merged.annot[merged.annot$EnsemblId == "ENSG00000183474", ]
merged.annot[merged.annot$EnsemblId == "ENSG00000099974" & merged.annot$EntrezId == "100037417", ]
merged.annot["4448",] <- merged.annot["4449",]
merged.annot[merged.annot$EntrezId == merged.annot["4448", "EntrezId"], ]
all(lapply(as.character(merged.annot$EnsemblId), nchar) == 15)
### Duplicates Ensambl Take 3
merged.annot[duplicated(merged.annot), ]
### Duplicates Ensambl Take 3
merged.annot[duplicated(merged.annot), ]
merged.annot <- merged.annot[!duplicated(merged.annot), ]
dim(merged.annot)
dup.ensembl.ids <- which(duplicated(merged.annot$EnsemblId))
dup.ensembl <-unique(merged.annot[dup.ensembl.ids, "EnsemblId"])
dup.ensembl.rows <- merged.annot[which(merged.annot$EnsemblId %in% dup.ensembl), ]
dim(dup.ensembl.rows)
### [1] 16  9
length(unique(dup.ensembl.rows$EntrezId))
dup.ensembl.rows
dup.ensembl.rows[order(dup.ensembl.rows$EnsemblId, dup.ensembl.rows$EntrezId), ]
dup.ensembl.rows$EnsemblId
unique(dup.ensembl.rows$EnsemblId)
#### Get the Counts
dup.ensembl.ids <- which(rownames(normal.df) %in% dup.ensembl.rows$EntrezId)
dup.ensembl.rows$EE <- paste(dup.ensembl.rows$EnsemblId, dup.ensembl.rows$EntrezId, sep=".")
length(dup.ensembl.ids)
dup.ensembl.counts <- normal.df[dup.ensembl.ids, ]
rownames(dup.ensembl.counts) <- dup.ensembl.rows$EE
dup.ensembl.counts <- dup.ensembl.counts[order(rownames(dup.ensembl.counts)), ]
dup.ensembl.counts
tail(dup.ensembl.counts)
load(file="cancerRawLegacy.RData")
cancer.df <- data.frame(cancer$Counts)
tumor.df <- data.frame(tumor$Counts)
head(tumor.df)
dim(tumor.df)
load(file="healthyRawLegacy.RData")
###### Healthy Data Frame
normal.df <- data.frame(normal$Counts)
head(normal.df)
dim(normal.df)
setdiff(normal$Annot[,2], tumor$Annot[,2])
length(normal$Annot)
length(tumor$Annot)
setdiff(normal$Annot, tumor$Annot)
tail(tumor.df)
dup.entrez.ids <-which(duplicated(merged.annot$EntrezId))
dup.entrez <- unique(merged.annot[dup.entrez.ids, "EntrezId"])
dup.entrez.rows <- merged.annot[which(merged.annot$EntrezId %in% dup.entrez), ]
dim(dup.entrez.rows)
dup.entrez.rows
